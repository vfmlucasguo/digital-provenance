#!/bin/bash

# AIæ•°å­—æº¯æºç³»ç»Ÿå®žæ—¶éªŒè¯è„šæœ¬
# éªŒè¯GitHub Actionså·¥ä½œæµæ˜¯å¦æ­£å¸¸è¿è¡Œ

echo "ðŸ” AIæ•°å­—æº¯æºç³»ç»Ÿå®žæ—¶éªŒè¯"
echo "================================="
echo ""

# æ£€æŸ¥æœ¬åœ°GitçŠ¶æ€
echo "ðŸ“Š æœ¬åœ°GitçŠ¶æ€æ£€æŸ¥:"
echo "â€¢ å½“å‰åˆ†æ”¯: $(git branch --show-current)"
echo "â€¢ æœ€æ–°æäº¤: $(git log -1 --oneline)"
echo "â€¢ è¿œç¨‹çŠ¶æ€: $(git status -s | wc -l | xargs echo)ä¸ªæœªæäº¤æ›´æ”¹"
echo ""

# æ£€æŸ¥å·¥ä½œæµæ–‡ä»¶
echo "ðŸ“‹ å·¥ä½œæµé…ç½®æ£€æŸ¥:"
if [ -f ".github/workflows/digital-provenance.yml" ]; then
    echo "âœ… ä¸»å·¥ä½œæµæ–‡ä»¶å­˜åœ¨: digital-provenance.yml"
else
    echo "âŒ ä¸»å·¥ä½œæµæ–‡ä»¶ç¼ºå¤±"
fi

if [ -f ".github/workflows/multi-environment-deployment.yml.disabled" ]; then
    echo "âœ… å¤šçŽ¯å¢ƒå·¥ä½œæµå·²ç¦ç”¨: multi-environment-deployment.yml.disabled"
else
    echo "âš ï¸ å¤šçŽ¯å¢ƒå·¥ä½œæµçŠ¶æ€æœªçŸ¥"
fi
echo ""

# æ£€æŸ¥å¿…éœ€çš„è„šæœ¬æ–‡ä»¶
echo "ðŸ”§ æ ¸å¿ƒè„šæœ¬æ£€æŸ¥:"
REQUIRED_SCRIPTS=(
    "scripts/process_aibom.py"
    "cosign.key"
    "cosign.pub"
)

for script in "${REQUIRED_SCRIPTS[@]}"; do
    if [ -f "$script" ]; then
        echo "âœ… $script å­˜åœ¨"
    else
        echo "âŒ $script ç¼ºå¤±"
    fi
done
echo ""

# æ£€æŸ¥GitHub SecretsçŠ¶æ€æç¤º
echo "ðŸ”‘ GitHub Secretsæ£€æŸ¥æé†’:"
echo "è¯·ç¡®è®¤ä»¥ä¸‹Secretså·²åœ¨GitHubä»“åº“ä¸­è®¾ç½®:"
echo "â€¢ COSIGN_PRIVATE_KEY (cosign.keyæ–‡ä»¶å†…å®¹)"
echo "â€¢ COSIGN_PASSWORD (å¯†é’¥å¯†ç )"
echo ""
echo "æ£€æŸ¥æ–¹æ³•: https://github.com/$(git remote get-url origin | sed 's/.*github.com[:/]//' | sed 's/.git$//')/settings/secrets/actions"
echo ""

# æä¾›GitHub Actionsé“¾æŽ¥
echo "ðŸš€ GitHub Actionsç›‘æŽ§:"
REPO_URL=$(git remote get-url origin | sed 's/.git$//' | sed 's/https:\/\/.*@github\.com/https:\/\/github.com/')
echo "â€¢ Actionsé¡µé¢: $REPO_URL/actions"
echo "â€¢ æœ€æ–°è¿è¡Œ: $REPO_URL/actions/runs"
echo ""

# é¢„æœŸç»“æžœè¯´æ˜Ž
echo "ðŸŽ¯ é¢„æœŸè¿è¡Œç»“æžœ:"
echo "â€¢ å·¥ä½œæµåç§°: 'AI Digital Provenance (Simplified)'"
echo "â€¢ æ‰§è¡Œæ—¶é—´: 2-3åˆ†é’Ÿ"
echo "â€¢ çŠ¶æ€: ç»¿è‰²âœ… (æˆåŠŸ) æˆ– çº¢è‰²âŒ (å¤±è´¥)"
echo "â€¢ è¾“å‡º: AIæ£€æµ‹ç»“æžœå’ŒSBOMç»Ÿè®¡"
echo ""

# AIæ£€æµ‹æµ‹è¯•å»ºè®®
echo "ðŸ§ª AIæ£€æµ‹åŠŸèƒ½æµ‹è¯•:"
echo "å¦‚æžœæƒ³æµ‹è¯•AIæ£€æµ‹åŠŸèƒ½ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªAIç”Ÿæˆçš„æµ‹è¯•æ–‡ä»¶:"
echo ""
echo "cat > src/app/test-ai-component.ts << 'EOF'"
echo "// Generated by Claude AI"
echo "// This is an AI-generated test component"
echo "export class TestAIComponent {"
echo "  // Auto-generated method"
echo "  testMethod() {"
echo "    console.log('AI generated test method');"
echo "  }"
echo "}"
echo "EOF"
echo ""
echo "ç„¶åŽæäº¤å¹¶æŽ¨é€:"
echo "git add src/app/test-ai-component.ts"
echo "git commit -m 'test: æ·»åŠ AIç”Ÿæˆä»£ç æµ‹è¯•æ–‡ä»¶'"
echo "git push origin main"
echo ""

# æ•…éšœæŽ’é™¤æŒ‡å—
echo "ðŸ†˜ æ•…éšœæŽ’é™¤:"
echo "å¦‚æžœå·¥ä½œæµå¤±è´¥ï¼Œè¯·æ£€æŸ¥:"
echo "1. GitHub Secretsæ˜¯å¦æ­£ç¡®è®¾ç½®"
echo "2. cosign.keyå’Œcosign.pubæ–‡ä»¶æ˜¯å¦å­˜åœ¨"
echo "3. process_aibom.pyè„šæœ¬æ˜¯å¦å¯æ‰§è¡Œ"
echo "4. ç½‘ç»œè¿žæŽ¥æ˜¯å¦æ­£å¸¸ï¼ˆä¸‹è½½Syftå’ŒCosignï¼‰"
echo ""

echo "âœ… éªŒè¯è„šæœ¬æ‰§è¡Œå®Œæˆ"
echo "è¯·è®¿é—®GitHub Actionsé¡µé¢æŸ¥çœ‹å®žé™…è¿è¡ŒçŠ¶æ€"